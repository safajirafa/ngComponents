// IMS Brogan
// Component: IMSTreeSelector
// Version: 0.0.1
// Built date: 2013-08-29T14:32:52
var IMSTreeSelector=angular.module("com.ims.treeSelector",[]);IMSTreeSelector.run(function(){}),IMSTreeSelector.directive("treeSelector",function(selectorServices){"use strict";return{restrict:"EA",replace:!0,scope:{context:"@",config:"="},templateUrl:"treeSelector.tmpl.html",link:function(scope){scope.itemArrayLoaded=!1,scope.displayPopover=!1,scope.config.enabled=!1,scope.togglePopover=function(){scope.displayPopover?scope.closePopover():scope.openPopover()},scope.closePopover=function(){scope.displayPopover=!1},scope.openPopover=function(){scope.displayPopover=!0},scope.enableSelector=function(){scope.config.enabled=!0},scope.disableSelector=function(){scope.config.enabled=!1},scope.$watch("config.itemArray",function(newVal){scope.itemArrayLoaded=newVal.length>0?!0:!1}),scope.$watch("itemArrayLoaded",function(newVal){newVal===!0&&scope.enableSelector()}),scope.$watch("config.enabled",function(newVal){newVal===!1&&(scope.config.activeTitle=scope.config.label,scope.closePopover())}),selectorServices.getItemArray(scope.config).then(function(itemArray){scope.config.itemArray=itemArray}),$(document).on("change",'input[name="'+scope.config.label+'"]',function(event){console.log(event);var newTitle=$(this).siblings("span").text(),newKey=$(this).val();scope.$apply(function(){scope.config.activeTitle=newTitle,scope.config.activeKey=newKey,scope.closePopover()})})}}}),IMSTreeSelector.factory("selectorServices",function($q,$http){"use strict";return{getItemArray:function(params){var deferred=$q.defer();return"/services/alignments"===params.resourceUrl&&deferred.resolve([{key:"A\\#/PRX\\#/94035\\#/015T\\#/T0\\#/\\#/1\\#/",title:"NATIONAL PC 015T",metadata:{alignment:"015T",level:"1",isLeaf:"0"},children:[]},{key:"A\\#/PRX\\#/94035\\#/015C\\#/C00\\#/\\#/1\\#/",title:"NATIONAL DIABET 015C",metadata:{alignment:"015C",level:"1",isLeaf:"0"},children:[]},{key:"A\\#/PRX\\#/94035\\#/015R\\#/R00\\#/\\#/1\\#/",title:"NATIONAL RP/RHE 015R",metadata:{alignment:"015R",level:"1",isLeaf:"0"},children:[]},{key:"A\\#/PRX\\#/94035\\#/015V\\#/V00\\#/\\#/1\\#/",title:"NATIONAL CV 015V",metadata:{alignment:"015V",level:"1",isLeaf:"0"},children:[]},{key:"A\\#/PRX\\#/119555\\#/306P\\#/PCANA\\#/\\#/1\\#/",title:"CANADA 306P",metadata:{alignment:"306P",level:"1",isLeaf:"0"},children:[]}]),"/services/geos"===params.resourceUrl,"/services/timePeriods"===params.resourceUrl&&deferred.resolve([{key:"TP\\#/L12M\\#/L12M_TP_CALC_CD\\#/L12M\\#/MTH_DISPLAY_TXT\\#/L12M_TP_CALC_CD\\#/L12M\\#/LY_MTH_DISPLAY_TXT\\#/0",title:"MAT",metadata:{}},{key:"TP\\#/CURRENT_MONTH\\#/MTH_TP_CALC_CD\\#/CURR_MONTH\\#/MTH_DISPLAY_TXT\\#/MTH_TP_CALC_CD\\#/CURR_MONTH\\#/LY_MTH_DISPLAY_TXT\\#/0",title:"CURR_MTH",metadata:{}},{key:"TP\\#/CURRENT_QUARTER\\#/L12M_TP_CALC_CD\\#/L12M\\#/QTR_DISPLAY_TXT\\#/QTR_TP_CALC_CD\\#/L3M\\#/-\\#/0",title:"ROLLING_QTRS",metadata:{}},{key:"TP\\#/L6M\\#/L6M_TP_CALC_CD\\#/L6M\\#/MTH_DISPLAY_TXT\\#/L6M_TP_CALC_CD\\#/L6M\\#/LY_MTH_DISPLAY_TXT\\#/0",title:"L6M",metadata:{}},{key:"TP\\#/L24M\\#/L12M_TP_CALC_CD\\#/L12M\\#/MTH_DISPLAY_TXT\\#/L12M_TP_CALC_CD\\#/L12M\\#/LY_MTH_DISPLAY_TXT\\#/1",title:"L24M",metadata:{}},{key:"TP\\#/YTD\\#/YTD_TP_CALC_CD\\#/YTD\\#/MTH_DISPLAY_TXT\\#/YTD_TP_CALC_CD\\#/YTD\\#/LY_MTH_DISPLAY_TXT\\#/0",title:"YTD",metadata:{}}]),"/services/metrics"===params.resourceUrl&&deferred.resolve([{key:"MT\\#/PRX\\#/1\\#/TRX_VOL_QTY\\#/LY_TRX_VOL_QTY\\#/TARGET_VOL",title:"TRx",metadata:{columnName:"TRX_VOL_QTY",type:"",grpLbl:"TRx"}},{key:"MT\\#/PRX\\#/0\\#/NRX_VOL_QTY\\#/LY_NRX_VOL_QTY\\#/TARGET_VOL",title:"NRx",metadata:{columnName:"NRX_VOL_QTY",type:"",grpLbl:"NRx"}},{key:"MT\\#/PRX\\#/1\\#/TRX_VOL_QTY_MS\\#/LY_TRX_VOL_QTY_MS\\#/",title:"TRx MS",metadata:{columnName:"TRX_VOL_QTY_MS",type:"",grpLbl:"TRx"}},{key:"MT\\#/PRX\\#/0\\#/NRX_VOL_QTY_MS\\#/LY_NRX_VOL_QTY_MS\\#/",title:"NRx MS",metadata:{columnName:"NRX_VOL_QTY_MS",type:"",grpLbl:"NRx"}}]),deferred.promise},getAsyncResource:function(requestConfig){var deferred=$q.defer();return $http(requestConfig).success(function(data){deferred.resolve(data)}).error(function(data,status){alert(requestConfig.ex.msg),console.error(data,status),deferred.reject()}),deferred.promise}}});